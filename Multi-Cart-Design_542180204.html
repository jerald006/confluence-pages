<!DOCTYPE html>
<html>
    <head>
        <title>XeniApp : Multi Cart Design</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">XeniApp</a></span>
                            </li>
                                                    <li>
                                <span><a href="XeniApp_542179373.html">XeniApp</a></span>
                            </li>
                                                    <li>
                                <span><a href="Features---XeniApp_542180062.html">Features - XeniApp</a></span>
                            </li>
                                                    <li>
                                <span><a href="MultiCart_542180350.html">MultiCart</a></span>
                            </li>
                                                    <li>
                                <span><a href="Design_542180550.html">Design</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            XeniApp : Multi Cart Design
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> User 719b7</span>, last modified on May 09, 2022
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <img class="wysiwyg-unknown-macro" src="plugins/servlet/confluence/placeholder/unknown-macro"/><style>[data-colorid=kcnc56b6ew]{color:#bf2600} html[data-color-mode=dark] [data-colorid=kcnc56b6ew]{color:#ff6640}</style><p><strong>&nbsp;</strong></p><ol><li><p><strong>Cart Events/Operation: </strong>User can perform following cart operations,</p></li></ol><ul><li><p><strong>Add to Cart: </strong>Add product itinerary information from results to Cart&nbsp;</p></li><li><p><strong>Cart Validation: </strong>Cart validation is next action after &ldquo;<strong>Add to Cart</strong>&rdquo; </p><p>Max 12 products available and 4 of each type.</p></li><li><p><strong>Remove From Cart: </strong>Remove product from Cart</p></li><li><p><strong>Clear Cart: </strong>Remove all items from the Cart</p></li><li><p><strong>Cart Expiry : </strong>Default cart expiry time is 20 mins after clicking checkout.</p></li><li><p><strong>View Cart: </strong>Get cart itinerary and display. View cart will also be consider as checkout and hence, on <strong>View Cart </strong>action will check the price and availability of each products<strong> </strong>in cart.</p></li><li><p><strong>Save Cart: </strong>Store cart to persistent storage</p></li><li><p><strong>Refresh Cart: </strong>Check price and availability of each products<strong> </strong>in cart. If there is price/availability change show user alert.</p></li><li><p><strong>E.g. </strong>In XeniApp2.0 implementation checking price of hotel on checkout,</p></li></ul><p><strong>Get Latest Price and Availability for each product in the cart.</strong></p><div class="table-wrap"><table data-layout="default" data-local-id="7650e95b-cf9a-4913-b4de-da29efb32116" class="confluenceTable"><colgroup><col style="width: 187.0px;"/><col style="width: 573.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p><strong>Endpoint</strong></p></td><td class="confluenceTd"><p>/api/cart/{id}/price</p></td></tr><tr><td class="confluenceTd"><p><strong>Verb</strong></p></td><td class="confluenceTd"><p>GET</p></td></tr><tr><td class="confluenceTd"><p><strong>Content type</strong></p></td><td class="confluenceTd"><p>application/json</p></td></tr><tr><td class="confluenceTd"><p><strong>Response</strong></p></td><td class="confluenceTd"><p>{</p><p>&nbsp; &nbsp; &nbsp; status: &ldquo;success&rdquo;,</p><p>&nbsp; &nbsp; &nbsp; response: {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; id: string,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; key: string,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; version: number,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; createdAt: datetime,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; totalPrice: float,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; taxAndFees: float,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; markup: float,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currency: string (USD),</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lastmodifiedAt: datetime,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; products<strong>: [</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>{</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>type: flight,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>productRph: number, (Product Reference Place Holder &ndash; index code to identify product in cart)</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>status: boolean, (availability status)</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>statusCode: integer, (0-No change, 1-Price Change, 2- No Availability )</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>message: string,</strong></p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {From/To, Departure/Arrival date &amp; time (12 hr format), Airline name, Baggage, Number of travellers, total flight duration, Number of stops (hyperlink to display- Stop details), Class (info icon for Cabin details), Price for each flight, Flight total}</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>{</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>type: hotel,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>productRph: number,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>status: boolean, (availability status)</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>statusCode: integer, (0-No change, 1-Price Change, 2- No Availability )</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>message: string,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {Hotel name, Hotel address, Star rating, Check-in/Check-out Date, number of days stay, Room quantity and type, number of guests, Non-refundable(info icon to display cancellation policy) , Hotel total (info icon to display Hotel price details including taxes and fees)}</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type: <strong>CarRentals,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>productRph: number,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>status: boolean, (availability status)</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>statusCode: integer, (0-No change, 1-Price Change, 2- No Availability )</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>message: string,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Vehicle Name &amp; type, Agency name, Pick-up/Drop-off location, date, and time (12 hr format), Number of passengers, baggage and doors, cancellation policy (info icon to display cancellation policy) , Car Features (AC, Automatic), Car total (info icon to display car rental price details including taxes and fees)}</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>]</strong></p><p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</strong></p><p>}</p></td></tr></tbody></table></div><p><strong>&nbsp;</strong></p><p>After each of above operation, app will have to fetch user profile by using <strong>getProfile</strong> API and it will return cart details (id and )</p><div class="table-wrap"><table data-layout="default" data-local-id="ba3db3b2-b867-49e3-89d0-cd0547ed0243" class="confluenceTable"><colgroup><col style="width: 171.0px;"/><col style="width: 509.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p><strong>Endpoint</strong></p></td><td class="confluenceTd"><p>/api/user/getProfile</p><p>Where id = unique cart id.</p></td></tr><tr><td class="confluenceTd"><p><strong>Verb</strong></p></td><td class="confluenceTd"><p>GET</p></td></tr><tr><td class="confluenceTd"><p><strong>Content type</strong></p></td><td class="confluenceTd"><p>application/json</p></td></tr><tr><td class="confluenceTd"><p><strong>Response</strong></p></td><td class="confluenceTd"><p>{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; userType: string (e.g. AgencyOwner),</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; isCreditCard&quot;: true,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; personal_info: {</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; first_name: string,</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; last_name&quot;: string,</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; email: string,</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; credits: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; amount: number,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; currency: string(USD)</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loginCount: number</p><p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</p><p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; address_info: {</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; home_airport: string,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; street_address: string,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; state: string,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; country: string,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; city: string</p><p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>cart_details: [</strong></p><p><strong>&nbsp;&nbsp;&nbsp; </strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>{</strong></p><p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>id: string,</strong></p><p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>createdAt: datetime,</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; comments: string, </strong>(Agent can add notes/comments)</p><p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>products_count: number,&nbsp;&nbsp;</strong></p><p><strong>&nbsp;&nbsp;&nbsp; </strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>}</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>]</strong></p><p>}</p></td></tr></tbody></table></div><p><strong>&nbsp;</strong></p><p><strong>2. Cart API Gateway:</strong></p><p> Implement Cart API gateway to support all above mentioned options by APIs. Cart API gateway will get updated price and availability by using supplier APIs.</p><p>Cart for each user will be save to separate table. We can save products JSON to same table as we are using <strong>MongoDB</strong>.</p><p><strong><span data-colorid="kcnc56b6ew">NOTE: These APIs will be authorise by using token.</span></strong></p><ul><li><p><strong>Add to Cart</strong></p></li></ul><div class="table-wrap"><table data-layout="default" data-local-id="e651219c-2906-4c41-a0a6-f791149f6410" class="confluenceTable"><colgroup><col style="width: 181.0px;"/><col style="width: 499.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p><strong>Endpoint</strong></p></td><td class="confluenceTd"><p>/api/cart</p></td></tr><tr><td class="confluenceTd"><p><strong>Verb</strong></p></td><td class="confluenceTd"><p>POST</p></td></tr><tr><td class="confluenceTd"><p><strong>Content type</strong></p></td><td class="confluenceTd"><p>application/json</p></td></tr><tr><td class="confluenceTd"><p><strong>Payload</strong></p></td><td class="confluenceTd"><p>[</p><p>&nbsp; {</p><p>&nbsp;&nbsp;&nbsp;&nbsp; type: &ldquo;flight/car/hotel&rdquo;,</p><p>&nbsp; &nbsp;&nbsp;&nbsp;&lt;flight/hotel/car-rental itinerary object&gt;</p><p>&nbsp; },</p><p>]</p></td></tr><tr><td class="confluenceTd"><p><strong>Response</strong></p></td><td class="confluenceTd"><p>{</p><p>   status: &ldquo;success&rdquo;,</p><p>&nbsp;  Id: string (unique cart id),</p><p>   productRph: number,</p><p>}</p></td></tr></tbody></table></div><p>&nbsp;</p><ul><li><p> <strong>Get Cart</strong></p></li></ul><div class="table-wrap"><table data-layout="default" data-local-id="c6ba9964-c882-4c80-957f-b1db4ecd0218" class="confluenceTable"><colgroup><col style="width: 177.0px;"/><col style="width: 503.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p><strong>Endpoint</strong></p></td><td class="confluenceTd"><p>/api/cart/{id}</p></td></tr><tr><td class="confluenceTd"><p><strong>Verb</strong></p></td><td class="confluenceTd"><p>GET</p></td></tr><tr><td class="confluenceTd"><p><strong>Content Type</strong></p></td><td class="confluenceTd"><p>application/json</p></td></tr><tr><td class="confluenceTd"><p><strong>Response</strong></p></td><td class="confluenceTd"><p>{</p><p>&nbsp; &nbsp; &nbsp; status: &ldquo;success&rdquo;,</p><p>&nbsp; &nbsp; &nbsp; response: {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; id: string,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; key: string,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; version: number,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; createdAt: datetime,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; totalPrice: float,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; taxAndFees: float,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; markup: float,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currency: string (USD),</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lastmodifiedAt: datetime,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; products<strong>: [</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>{</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>type: flight,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>productRph: number, (Product Reference Place Holder &ndash; Index code to identify product in cart)</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>status: boolean, (availability status)</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>statusCode: integer, (0-No change, 1-Price Change, 2- No Availability )</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>message: string,</strong></p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {From/To, Departure/Arrival date &amp; time (12 hr format), Airline name, Baggage, Number of travellers, total flight duration, Number of stops (hyperlink to display- Stop details), Class (info icon for Cabin details), Price for each flight, Flight total}</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>{</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>type: hotel,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>productRph: number,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>status: boolean, (availability status)</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>statusCode: integer, (0-No change, 1-Price Change, 2- No Availability )</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>message: string,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {Hotel name, Hotel address, Star rating, Check-in/Check-out Date, number of days stay, Room quantity and type, number of guests, Non-refundable(info icon to display cancellation policy) , Hotel total (info icon to display Hotel price details including taxes and fees)}</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type: <strong>CarRentals,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>productRph: number,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>status: boolean, (availability status)</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>statusCode: integer, (0-No change, 1-Price Change, 2- No Availability )</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>message: string,</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Vehicle Name &amp; type, Agency name, Pick-up/Drop-off location, date, and time (12 hr format), Number of passengers, baggage and doors, cancellation policy (info icon to display cancellation policy) , Car Features (AC, Automatic), Car total (info icon to display car rental price details including taxes and fees)}</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>]</strong></p><p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</strong></p><p>}</p></td></tr></tbody></table></div><p>&nbsp;&nbsp;</p><ul><li><p><strong>Save Cart:  </strong>We have done investigation and analysis for reducing number database operation on each Cart API call by storing cart to backend session storage. And only trigger cart storing operation when user perform <strong>&ldquo;Proceed To Checkout&ldquo;</strong> action. But this will cause maintaining updated cart in multiple session of same user. Hence we have decided to go with conventional shopping cart design where we will be performing database operation on every Cart gateway API call.</p></li></ul><p/><ul><li><p><strong>Remove to Cart</strong></p></li></ul><div class="table-wrap"><table data-layout="default" data-local-id="79c937b2-3dcc-4541-9f5e-e37181d28b9f" class="confluenceTable"><colgroup><col style="width: 183.0px;"/><col style="width: 497.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p><strong>Endpoint</strong></p></td><td class="confluenceTd"><p>/api/cart/{id}/{productRph}</p><p>Where, id=cart id,</p><p>productRph = Reference Place Holder &ndash; Index code to identify product in cart.</p></td></tr><tr><td class="confluenceTd"><p><strong>Verb</strong></p></td><td class="confluenceTd"><p>DELETE</p></td></tr><tr><td class="confluenceTd"><p><strong>Content Type</strong></p></td><td class="confluenceTd"><p>application/json</p></td></tr><tr><td class="confluenceTd"><p><strong>Response</strong></p></td><td class="confluenceTd"><p>{</p><p>&nbsp;status: &ldquo;success&rdquo;,</p><p>}</p></td></tr></tbody></table></div><p>&nbsp;</p><ul><li><p><strong>Clear All Cart</strong></p></li></ul><div class="table-wrap"><table data-layout="default" data-local-id="07dbb67e-df35-4051-8da1-73f602f8bf93" class="confluenceTable"><colgroup><col style="width: 181.0px;"/><col style="width: 499.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p><strong>Endpoint</strong></p></td><td class="confluenceTd"><p>/api/cart/{id}</p></td></tr><tr><td class="confluenceTd"><p><strong>Verb</strong></p></td><td class="confluenceTd"><p>DELETE</p></td></tr><tr><td class="confluenceTd"><p><strong>content-type</strong></p></td><td class="confluenceTd"><p>application/json</p></td></tr><tr><td class="confluenceTd"><p><strong>Response</strong></p></td><td class="confluenceTd"><p>{</p><p>&nbsp;status: &ldquo;success&rdquo;,</p><p>}</p></td></tr></tbody></table></div><p>&nbsp;</p><ul><li><p><strong>Refresh Cart (Check Price and Availability for each product in cart)</strong></p></li></ul><p>Note: Use same <strong>Get Latest Price and Availability </strong>API which will fetch latest price and availability for all product from the cart.</p><p><strong>&nbsp;</strong></p><p><strong>3. Proceed to Checkout</strong>: &nbsp;Get price and availability of each product before navigating checkout page.</p><p>&nbsp;</p><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" width="680" loading="lazy" src="attachments/542180204/542184089.png?width=680" data-image-src="attachments/542180204/542184089.png" data-height="180" data-width="430" data-unresolved-comment-count="0" data-linked-resource-id="542184089" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20220427-141631.png" data-base-url="https://xeni-workspace.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="542180204" data-linked-resource-container-version="14" data-media-id="a41fb98f-a717-4090-9a4b-4687f174e399" data-media-type="file"/></span><p/><p>&nbsp;</p><p><strong>4. Checkout Page and Validating User details:</strong> Validate traveller entered details based on each product type,</p><ul><li><p><strong>Flight-</strong>Title, First Name, Middle Name, Last Name, DOB, Gender, Phone, Email</p></li><li><p><strong>Hotel:</strong> Title, First Name, Last name for each guest</p></li><li><p><strong>Car Rental:</strong> Title, First Name, Last name, DOB, Gender, PHONE, Email, Address, Country, City, Region, Zip Code</p></li></ul><p><strong>Other Validations:</strong></p><ul><li><p>Max 9 pax collectively allowed in flights</p></li><li><p>Total 12 products allowed in a cart.</p></li><li><p>Max 4 products of each type(flight/hotel/car-rental) allowed in a cart</p></li></ul><p>These validation will be store in runtime configuration. Create API to fetch configuration and store validation configuration into cache with validity. &nbsp;This will be fetched at first time when application load.</p><div class="table-wrap"><table data-layout="default" data-local-id="05da0918-9e1e-4cdb-bccd-ef7f9c19ce3f" class="confluenceTable"><colgroup><col style="width: 202.0px;"/><col style="width: 478.0px;"/></colgroup><tbody><tr><td class="confluenceTd"><p><strong>Endpoint</strong></p></td><td class="confluenceTd"><p>/api/configurations</p></td></tr><tr><td class="confluenceTd"><p><strong>Verb</strong></p></td><td class="confluenceTd"><p>GET</p></td></tr><tr><td class="confluenceTd"><p><strong>Content type</strong></p></td><td class="confluenceTd"><p>application/json</p></td></tr><tr><td class="confluenceTd"><p><strong>Response</strong></p></td><td class="confluenceTd"><p>{</p><p>&nbsp;&nbsp; maxTotalProductsAllowed: number, (for now 12)</p><p>&nbsp;&nbsp; flight: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxTravellersAllowed: number, (for now 9)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxProductsAllowed: number, (for now 4)</p><p>&nbsp;&nbsp; },</p><p>&nbsp;&nbsp; hotel: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxProductsAllowed: number, (for now 4)</p><p>&nbsp;&nbsp; },</p><p>&nbsp;&nbsp; carRental: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxProductsAllowed: number, (for now 9)</p><p>&nbsp;&nbsp; }</p><p>&nbsp;}</p></td></tr></tbody></table></div><p>&nbsp;</p><p>&nbsp;</p><p><strong>5. Billing Details and Select Payment Modes: </strong>On the Select Payment Method step, the customer can specify a billing address, choose a payment method, and apply markup. Actions like applying a customer balance, applying markup triggers the recalculation of the totals. This Module will work same as Xeni2.0.</p><p>&nbsp;</p><p><strong>6. Review Order: </strong>The payment review step also contains summary details like items, markup, totals, taxes etc. This is a must step after all validation will be done,</p><p>&nbsp;</p><p><strong>7. Pay Securely: </strong>After order review when user clicks on &ldquo;<strong>Pay Securely</strong>&rdquo; button</p><ul><li><p>Before moving to payment all validations as per above mentioned points <strong>4, 5</strong> and <strong>6</strong> should be done along with user agreement on <strong>terms and conditions.</strong></p></li><li><p>Payment will be processed as per sequence order of <strong>Flights, Refundable Hotels, Refundable Car-Rentals, Non-Refundable Hotels and Non-Refundable Car-Rentals</strong></p></li><li><p>Process payment of one product as time.                                                                                                   Payment gateway will be doing below mentioned three operations as part of completing secure payment.</p><p><strong>Authorize: </strong>When Payment gateway authorize a user credit card, we check with the user bank to see if the credit card is legitimate and has sufficient funds for the amount you authorized. If the user bank approves, a hold is placed on the funds in the user account but no money has moved, yet.</p><p><strong>Capture: </strong>In order to actually move money from the user account, we have to issue a capture request on the original authorization to collect (&quot;capture&quot;) the funds.</p><p><strong>Cancel: </strong>If we choose not to capture the funds from the user account, we can explicitly cancel the authorization to release the hold on those funds.</p><p><strong>&nbsp;</strong></p><p>To avoid transactional/fraudulent issues due to multiple payments in quick succession. We will call <strong>Authorise Only</strong> API to authorise user and block cart total value and once booking will be done then only call <strong>Capture</strong> API to transfer funds from user account to XeniApp account.</p><p>&nbsp;</p><p>We have verified that Authorise only service is supported by all popular gateways including Stripe and ConnexPay.</p><p>&nbsp;</p><p>Please refer respective payment gateway documentation,</p><p><strong>Stripe:</strong> <a class="external-link" data-card-appearance="inline" href="https://stripe.com/docs/payments/capture-later" rel="nofollow">https://stripe.com/docs/payments/capture-later</a> </p><p><strong>ConnexPay:</strong> <a class="external-link" data-card-appearance="inline" href="https://docs.connexpay.com/reference/auth-only" rel="nofollow">https://docs.connexpay.com/reference/auth-only</a> <a class="external-link" data-card-appearance="inline" href="https://docs.connexpay.com/docs/auth-and-capture" rel="nofollow">https://docs.connexpay.com/docs/auth-and-capture</a> </p></li><li><p>If payment successful then process booking one by one each product. </p></li><li><p>After all booking will be done, then we will capture actual amount based on bookings.</p></li></ul><p><strong>&nbsp;</strong></p><p><strong>8. Booking:</strong> Booking will work in synchronous manner based on priority order (flights, hotels and car-rentals) one by one. This flow will remain same as current XeniApp 2.0 flow</p><p><strong>&nbsp;</strong></p><p>The following sequence diagram shows how to add product to cart and the place order will look like according to the proposed solution:</p><img class="wysiwyg-unknown-macro" src="plugins/servlet/confluence/placeholder/unknown-macro"/><p><strong>Notes:&nbsp;</strong></p><p/><p><strong>Multi-Cart Checkout Use Cases:</strong></p><p>&middot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Cart it's just a storage for items and might have only totals estimation</p><p>&middot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Product Itinerary and cart will have its own availability expiry.</p><p>&middot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The totals calculation is concentrated into a separate independent component.</p><p><strong>Note: Most of the actions like page reloading. triggers whole cart recalculation.</strong></p><p>&middot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Cart might receive updates about products price changes.</p><p>&middot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Localize currency selector, zip-code, region etc based on the selected country</p><p>&middot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Avoid surprise cost increase on the later checkout stages, be as transparent as possible on every step</p><p>o&nbsp;&nbsp; E.g. Cart price rules should be calculated during checkout, not just before placing the order</p><p>&middot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Push notifications do not make sense since checkout is usually pretty quick. The chance of price changing during checkout is slim</p><p><strong>&nbsp;</strong></p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542185249.png">image-20220427-141238.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542184089.png">image-20220427-141631.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183685.drawio">1_multicart_design_diagram.drawio</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183737.png">1_multicart_design_diagram.drawio.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183709.drawio">1_multicart_design_diagram.drawio</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183677.png">1_multicart_design_diagram.drawio.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542184069.drawio">cart_sequence_diagram.drawio</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542184161.png">cart_sequence_diagram.drawio.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183773.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542184085.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542184121.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183745.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183753.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183769.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183673.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183757.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183701.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542184105.tmp">~1_multicart_design_diagram.drawio.tmp</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183721.drawio">1_multicart_design_diagram.drawio</a> (application/vnd.jgraph.mxfile)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/542180204/542183749.png">1_multicart_design_diagram.drawio.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 24, 2024 07:09</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
